<!-- <app-widgets-dropdown /> -->
<!-- <c-card class="my-4">
  <c-card-body>
    <c-row>
      <c-col sm="5">
        <h4 class="card-title mb-0" id="traffic">Traffic</h4>
        <div class="small text-body-secondary">January - December 2023</div>
      </c-col>
      <c-col class="d-none d-md-block" sm="7">
        <button cButton class="float-end" color="primary" aria-label="Download">
          <svg cIcon name="cilCloudDownload"></svg>
        </button>
        <form [formGroup]="trafficRadioGroup">
          <c-button-group class="float-end me-3" role="group">
            <input
              class="btn-check"
              formControlName="trafficRadio"
              type="radio"
              value="Day"
              id="dayRadio"
            />
            <label
              (click)="setTrafficPeriod('Day')"
              cButton
              cFormCheckLabel
              color="secondary"
              variant="outline"
              for="dayRadio"
            >
              Day
            </label>
            <input
              class="btn-check"
              formControlName="trafficRadio"
              type="radio"
              value="Month"
              id="radioMonth"
            />
            <label
              (click)="setTrafficPeriod('Month')"
              cButton
              cFormCheckLabel
              color="secondary"
              variant="outline"
              for="radioMonth"
            >
              Month
            </label>
            <input
              class="btn-check"
              formControlName="trafficRadio"
              type="radio"
              value="Year"
              id="radioYear"
            />
            <label
              (click)="setTrafficPeriod('Year')"
              cButton
              cFormCheckLabel
              color="secondary"
              variant="outline"
              for="radioYear"
            >
              Year
            </label>
          </c-button-group>
        </form>
      </c-col>
    </c-row>
    <c-chart
      [data]="mainChart.data"
      [height]="300"
      style="margin-top: 40px;"
      [options]="mainChart.options"
      [type]="mainChart.type"
      (chartRef)="handleChartRef($event)"
    >
      Main chart
    </c-chart>
  </c-card-body>
  <c-card-footer>
    <c-row class="text-center mb-2" [xl]="5" [lg]="4" [sm]="2" [xs]="1" [gutter]="4">
      <c-col>
        <div class="text-body-secondary">Visits</div>
        <strong>29.703 Users (40%)</strong>
        <c-progress class="mt-2" thin color="success" value="40" aria-label="User visits" />
      </c-col>
      <c-col>
        <div class="text-body-secondary">Unique</div>
        <div class="fw-semibold text-truncate">24.093 Users (20%)</div>
        <c-progress class="mt-2" thin color="info" value="20" aria-label="Unique users" />
      </c-col>
      <c-col>
        <div class="text-body-secondary">Page views</div>
        <div class="fw-semibold text-truncate">78.706 Views (60%)</div>
        <c-progress class="mt-2" thin color="warning" value="60" aria-label="Page views" />
      </c-col>
      <c-col>
        <div class="text-body-secondary">New Users</div>
        <div class="fw-semibold text-truncate">22.123 Users (80%)</div>
        <c-progress class="mt-2" thin color="danger" value="80" aria-label="New users" />
      </c-col>
      <c-col class="d-none d-xl-block">
        <div class="text-body-secondary">Bounce Rate</div>
        <div class="fw-semibold text-truncate">Average Rate (40.15%)</div>
        <c-progress class="mt-2" thin value="40" aria-label="Bounce rate" />
      </c-col>
    </c-row>
  </c-card-footer>
</c-card>

<app-widgets-brand [withCharts]="true" />

<c-row class="mt-4">
  <c-col xs>
    <c-card class="mb-4">
      <c-card-header>Traffic {{ "&" }} Sales</c-card-header>
      <c-card-body>
        <c-row>
          <c-col md="6" xl="6" xs="12">
            <c-row>
              <c-col xs="6">
                <div class="border-start border-start-4 border-start-info py-1 px-3 mb-3">
                  <div class="text-body-secondary text-truncate small">New Clients</div>
                  <div class="fs-5 fw-semibold">9,123</div>
                </div>
              </c-col>
              <c-col xs="6">
                <div class="border-start border-start-4 border-start-danger py-1 px-3 mb-3">
                  <div class="text-body-secondary text-truncate small">
                    Recurring Clients
                  </div>
                  <div class="fs-5 fw-semibold">22,643</div>
                </div>
              </c-col>
            </c-row>
            <hr class="mt-0" />
            <div class="progress-group mb-4">
              <div class="progress-group-prepend">
                <span class="text-body-secondary small">Monday</span>
              </div>
              <div class="progress-group-bars">
                <c-progress thin color="info" value="34" aria-label="Monday new clients" />
                <c-progress thin color="danger" value="78" aria-label="Monday recurring clients" />
              </div>
            </div>
            <div class="progress-group mb-4">
              <div class="progress-group-prepend">
                <span class="text-body-secondary small">Tuesday</span>
              </div>
              <div class="progress-group-bars">
                <c-progress thin color="info" value="56" aria-label="Tuesday new clients" />
                <c-progress thin color="danger" value="94" aria-label="Tuesday recurring clients" />
              </div>
            </div>
            <div class="progress-group mb-4">
              <div class="progress-group-prepend">
                <span class="text-body-secondary small">Wednesday</span>
              </div>
              <div class="progress-group-bars">
                <c-progress thin color="info" value="12" aria-label="Wednesday new clients" />
                <c-progress thin color="danger" value="67" aria-label="Wednesday recurring clients" />
              </div>
            </div>
            <div class="progress-group mb-4">
              <div class="progress-group-prepend">
                <span class="text-body-secondary small">Thursday</span>
              </div>
              <div class="progress-group-bars">
                <c-progress thin color="info" value="43" aria-label="Thursday new clients" />
                <c-progress thin color="danger" value="91" aria-label="Thursday recurring clients" />
              </div>
            </div>
            <div class="progress-group mb-4">
              <div class="progress-group-prepend">
                <span class="text-body-secondary small">Friday</span>
              </div>
              <div class="progress-group-bars">
                <c-progress thin color="info" value="22" aria-label="Friday new clients" />
                <c-progress thin color="danger" value="73" aria-label="Friday recurring clients" />
              </div>
            </div>
            <div class="progress-group mb-4">
              <div class="progress-group-prepend">
                <span class="text-body-secondary small">Saturday</span>
              </div>
              <div class="progress-group-bars">
                <c-progress thin color="info" value="53" aria-label="Saturday new clients" />
                <c-progress thin color="danger" value="82" aria-label="Saturday recurring clients" />
              </div>
            </div>
            <div class="progress-group mb-4">
              <div class="progress-group-prepend">
                <span class="text-body-secondary small">Sunday</span>
              </div>
              <div class="progress-group-bars">
                <c-progress thin color="info" value="9" aria-label="Sunday new clients" />
                <c-progress thin color="danger" value="69" aria-label="Sunday recurring clients" />
              </div>
            </div>
            <div class="legend text-center d-none d-md-block" ngPreserveWhitespaces>
              <small>
                <sup>
                  <span class="badge badge-pill badge-sm bg-info">&nbsp;</span>
                </sup>
                <span>New clients</span>
                &nbsp;&nbsp;
                <sup>
                  <span class="badge badge-pill badge-sm bg-danger">&nbsp;</span>
                </sup>
                <span>Recurring clients</span>
              </small>
            </div>
          </c-col>

          <c-col md="6" xl="6" xs="12">
            <c-row>
              <c-col xs="6">
                <div class="border-start border-start-4 border-start-warning py-1 px-3 mb-3">
                  <div class="text-body-secondary text-truncate small">Page views</div>
                  <div class="fs-5 fw-semibold">78,623</div>
                </div>
              </c-col>
              <c-col xs="6">
                <div class="border-start border-start-4 border-start-success py-1 px-3 mb-3">
                  <div class="text-body-secondary text-truncate small">Organic</div>
                  <div class="fs-5 fw-semibold">49,123</div>
                </div>
              </c-col>
            </c-row>

            <hr class="mt-0" />

            <div class="progress-group mb-4">
              <div class="progress-group-header">
                <svg cIcon class="icon icon-lg me-2" name="cilUser"></svg>
                <span>Male</span>
                <span class="ms-auto font-semibold">43%</span>
              </div>
              <div class="progress-group-bars">
                <c-progress thin color="warning" value="43" aria-label="Male users" />
              </div>
            </div>
            <div class="progress-group mb-5">
              <div class="progress-group-header">
                <svg cIcon class="icon icon-lg me-2" name="cilUserFemale"></svg>
                <span>Female</span>
                <span class="ms-auto font-semibold">37%</span>
              </div>
              <div class="progress-group-bars">
                <c-progress thin color="warning" value="37" aria-label="Feale users" />
              </div>
            </div>

            <div class="progress-group">
              <div class="progress-group-header">
                <svg cIcon class="icon icon-lg me-2" name="cibGoogle"></svg>
                <span>Organic Search</span>
                <span class="ms-auto font-semibold">
                  191,235 <span class="text-body-secondary small">(56%)</span>
                </span>
              </div>
              <div class="progress-group-bars">
                <c-progress thin color="success" value="56" aria-label="Organic search" />
              </div>
            </div>
            <div class="progress-group">
              <div class="progress-group-header">
                <svg cIcon class="icon icon-lg me-2" name="cibFacebook"></svg>
                <span>Facebook</span>
                <span class="ms-auto font-semibold">
                  51,223 <span class="text-body-secondary small">(15%)</span>
                </span>
              </div>
              <div class="progress-group-bars">
                <c-progress thin color="success" value="15" aria-label="Facebook" />
              </div>
            </div>
            <div class="progress-group">
              <div class="progress-group-header">
                <svg cIcon class="icon icon-lg me-2" name="cibTwitter"></svg>
                <span>Twitter</span>
                <span class="ms-auto font-semibold">
                  37,564 <span class="text-body-secondary small">(11%)</span>
                </span>
              </div>
              <div class="progress-group-bars">
                <c-progress thin color="success" value="11" aria-label="Twitter" />
              </div>
            </div>
            <div class="progress-group">
              <div class="progress-group-header">
                <svg cIcon class="icon icon-lg me-2" name="cibLinkedin"></svg>
                <span>LinkedIn</span>
                <span class="ms-auto font-semibold">
                  27,319 <span class="text-body-secondary small">(8%)</span>
                </span>
              </div>
              <div class="progress-group-bars">
                <c-progress thin color="success" value="8" aria-label="LinkedIn" />
              </div>
            </div>
            <div class="divider d-flex justify-content-center">
              <button
                cButton
                class="text-muted btn-link"
                color="transparent"
                size="sm"
                type="button"
                aria-label="Options"
              >
                <svg cIcon name="cil-options"></svg>
              </button>
            </div>
          </c-col>
        </c-row>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>
<c-row>
  <c-col xs>
    <c-card class="mb-4">
      <c-card-body>
        <table
          [hover]="true"
          [responsive]="true"
          [striped]="true"
          align="middle"
          cTable
          class="mb-0 border"
        >
          <thead class="text-nowrap text-truncate">
          <tr>
            <th class="bg-body-tertiary text-center ">
              <svg cIcon name="cilPeople"></svg>
            </th>
            <th class="bg-body-tertiary">User</th>
            <th class="bg-body-tertiary text-center">Country</th>
            <th class="bg-body-tertiary">Usage</th>
            <th class="bg-body-tertiary text-center">Payment Method</th>
            <th class="bg-body-tertiary">Activity</th>
          </tr>
          </thead>
          <tbody>
            @for (user of users; track user.name; let i = $index) {
              <tr>
                <td class="text-center">
                  <c-avatar [size]="'md'" src="{{ user.avatar }}" status="{{ user.status }}" />
                </td>
                <td>
                  <div>{{ user.name }}</div>
                  <div class="small text-body-secondary text-nowrap">
                  <span>
                    {{ user.state }} | Registered: {{ user.registered }}
                  </span>
                  </div>
                </td>
                <td class="text-center">
                  <svg
                    cIcon
                    id="{{ user.country + user.name }}"
                    name="cif{{ user.country }}"
                    size="xl"
                    title="{{ user.country }}"
                  ></svg>
                </td>
                <td>
                  <div class="d-flex justify-content-between">
                    <div class="float-start">
                      <strong>{{ user.usage }}%</strong>
                    </div>
                    <div class="float-end ms-1 text-nowrap">
                      <small class="text-body-secondary">
                        {{ user.period }}
                      </small>
                    </div>
                  </div>
                  <c-progress thin [value]="user.usage" color="{{ user.color }}" aria-label="Usage" />
                </td>
                <td class="text-center">
                  <svg cIcon name="cibCc{{ user.payment }}" size="xl"></svg>
                </td>
                <td>
                  <div class="small text-body-secondary">Last login</div>
                  <div class="fw-semibold text-nowrap">{{ user.activity }}</div>
                </td>
              </tr>
            }
          </tbody>
        </table>
      </c-card-body>
    </c-card>
  </c-col>
</c-row> -->

Role Switcher (for demo purposes)
<div class="mb-4 p-3 bg-light rounded">
  <h5>Role Selector (Demo Only)</h5>
  <div class="btn-group" role="group">
    <button cButton color="primary" [variant]="userRole === 'admin' ? 'ghost' : 'outline'" (click)="switchRole('admin')">Admin</button>
    <button cButton color="primary" [variant]="userRole === 'staff' ? 'ghost' : 'outline'" (click)="switchRole('staff')">Staff</button>
    <button cButton color="primary" [variant]="userRole === 'supplier' ? 'ghost' : 'outline'" (click)="switchRole('supplier')">Executive Associate</button>
    <button cButton color="primary" [variant]="userRole === 'employee' ? 'ghost' : 'outline'" (click)="switchRole('employee')">Employee</button>
  </div>
</div>

<!-- ADMIN DASHBOARD -->
<div *ngIf="userRole === 'admin'">
  <h1 class="mb-4">Admin Dashboard</h1>
  
  <!-- Admin Stats Cards -->
  <c-row>
    <c-col sm="6" lg="3">
      <c-card class="mb-4 text-white bg-primary">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">৳{{ totalMonthlySales | number }}</div>
            <div>Total Sales (Month)</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="75" aria-label="Sales Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col>
    
    <c-col sm="6" lg="3">
      <c-card class="mb-4 text-white bg-info">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">৳{{ totalYearlySales | number }}</div>
            <div>Total Sales (Year)</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="80" aria-label="Yearly Sales Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col>
    

    
    <c-col sm="6" lg="3">
      <c-card class="mb-4 text-white bg-success">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">৳{{ netProfit | number }}</div>
            <div>Net Profit (Month)</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="65" aria-label="Profit Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col>
  </c-row>
  <!-- Add this card where you want the Installment Overview to appear -->
<c-card class="mb-4">
  <c-card-header>
    <strong>Installment Overview</strong>
    <small class="ms-1">(Current Month)</small>
  </c-card-header>
  <c-card-body>
    <!-- First row with counts -->
    <c-row>
      <c-col xs="6" xl="3">
        <div class="border-start border-start-4 border-start-success py-1 px-3 mb-3">
          <div class="text-medium-emphasis small">Regular</div>
          <div class="fs-5 fw-semibold d-flex align-items-center">
            {{ regularInstallments }}
            <span class="ms-2 small text-success">
              <i class="fas fa-check-circle"></i> On-time
            </span>
          </div>
        </div>
      </c-col>
      
      <c-col xs="6" xl="3">
        <div class="border-start border-start-4 border-start-warning py-1 px-3 mb-3">
          <div class="text-medium-emphasis small">Substandard</div>
          <div class="fs-5 fw-semibold d-flex align-items-center">
            {{ substandardInstallments }}
            <span class="ms-2 small text-warning">
              <i class="fas fa-exclamation-circle"></i> 30 days over
            </span>
          </div>
        </div>
      </c-col>
      
      <c-col xs="6" xl="3">
        <div class="border-start border-start-4 border-start-danger py-1 px-3 mb-3">
          <div class="text-medium-emphasis small">Doubtful</div>
          <div class="fs-5 fw-semibold d-flex align-items-center">
            {{ doubtfulInstallments }}
            <span class="ms-2 small text-danger">
              <i class="fas fa-exclamation-triangle"></i> 30-60 days over
            </span>
          </div>
        </div>
      </c-col>
      
      <c-col xs="6" xl="3">
        <div class="border-start border-start-4 border-start-dark py-1 px-3 mb-3">
          <div class="text-medium-emphasis small">Bad</div>
          <div class="fs-5 fw-semibold d-flex align-items-center">
            {{ badInstallments }}
            <span class="ms-2 small text-dark">
              <i class="fas fa-times-circle"></i> 60+ days over
            </span>
          </div>
        </div>
      </c-col>
    </c-row>
    
    <!-- Second row with the overall completion rate -->
    <div class="mb-3">
      <div class="d-flex justify-content-between mb-1">
        <div>Installment Completion</div>
        <div>{{ installmentCompletionRate }}%</div>
      </div>
      <c-progress thin>
        <c-progress-bar [value]="installmentCompletionRate" color="success"></c-progress-bar>
      </c-progress>
    </div>
    
    <!-- Third row with paid/due installments -->
    <c-row class="mt-3">
      <c-col sm="6" xl="6">
        <div class="border-start border-start-4 border-start-success py-1 px-3 mb-3">
          <div class="text-medium-emphasis small">Paid Installments</div>
          <div class="fs-5 fw-semibold d-flex align-items-center">
            {{ currentMonthPaidInstallments }}
            <span class="ms-2 small text-success">
              <i class="fas fa-check"></i> Customers
            </span>
          </div>
          <div class="text-medium-emphasis small">৳{{ paidInstallmentAmount | number }}</div>
        </div>
      </c-col>
      <c-col sm="6" xl="6">
        <div class="border-start border-start-4 border-start-danger py-1 px-3 mb-3">
          <div class="text-medium-emphasis small">Due Installments</div>
          <div class="fs-5 fw-semibold d-flex align-items-center">
            {{ currentMonthDueInstallments }}
            <span class="ms-2 small text-danger">
              <i class="fas fa-clock"></i> Customers
            </span>
          </div>
          <div class="text-medium-emphasis small">৳{{ dueInstallmentAmount | number }}</div>
        </div>
      </c-col>
    </c-row>
    
    <!-- Bottom row with total and button -->
    <c-row>
      <c-col sm="12">
        <div class="d-flex justify-content-between align-items-center border-top pt-3">
          <div>
            <div class="text-medium-emphasis">Total Installment Amount</div>
            <div class="fs-4 fw-semibold">৳{{ totalInstallmentAmount | number }}</div>
          </div>
          <button cButton color="primary" size="sm" class="d-flex align-items-center">
            <i class="fas fa-list me-2"></i> View All Installments
          </button>
        </div>
      </c-col>
    </c-row>
  </c-card-body>
</c-card>
  <!-- Product Search -->
  <!-- <c-card class="mb-4">
    <c-card-header>
      <strong>Product Search</strong>
    </c-card-header>
    <c-card-body>
      <c-row class="mb-3">
        <c-col md="6">
          <div class="input-group">
            <input 
              cFormControl 
              placeholder="Search products by name, category, or supplier..." 
              [(ngModel)]="searchQuery"
              (keyup.enter)="searchProducts()"
            />
            <button cButton color="primary" type="button" (click)="searchProducts()">
              <svg cIcon name="cilSearch"></svg> Search
            </button>
            <button cButton color="secondary" type="button" (click)="clearSearch()" *ngIf="searchQuery">
              <svg cIcon name="cilX"></svg> Clear
            </button>
          </div>
        </c-col>
      </c-row>
      
      <table cTable [hover]="true" [responsive]="true" *ngIf="filteredProducts.length > 0">
        <thead>
          <tr>
            <th>ID</th>
            <th>Product Name</th>
            <th>Category</th>
            <th>Price</th>
            <th>Stock</th>
            <th>Sales</th>
            <th>Supplier</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let product of filteredProducts">
            <td>{{ product.id }}</td>
            <td>{{ product.name }}</td>
            <td>{{ product.category }}</td>
            <td>৳{{ product.price | number }}</td>
            <td>{{ product.stock }}</td>
            <td>{{ product.sales }}</td>
            <td>{{ product.supplier }}</td>
            <td>
              <c-badge [color]="
                product.status === 'In Stock' ? 'success' : 
                product.status === 'Low Stock' ? 'warning' : 'danger'
              ">
                {{ product.status }}
              </c-badge>
            </td>
          </tr>
        </tbody>
      </table>
      
      <div *ngIf="filteredProducts.length === 0" class="text-center py-4">
        <p>No products found matching your search criteria.</p>
      </div>
    </c-card-body>
  </c-card> -->
  
  <!-- Monthly Sales Chart -->
  <c-card class="mb-4">
    <c-card-header>
      <strong>Monthly Product Sales</strong>
    </c-card-header>
    <c-card-body>
      <c-row>
        <c-col lg="8">
          <c-chart
            [data]="salesChart.data"
            [height]="300"
            [options]="salesChart.options"
            [type]="salesChart.type"
          >
            Sales chart
          </c-chart>
        </c-col>
        <c-col lg="4">
          <h5 class="mb-3">Product Quantity by Category</h5>
          <table cTable [hover]="true" [small]="true" class="mb-4">
            <thead>
              <tr>
                <th>Category</th>
                <th class="text-end">Quantity</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of productQuantityByCategory">
                <td>{{ item.category }}</td>
                <td class="text-end fw-bold">{{ item.quantity }}</td>
              </tr>
            </tbody>
            <tfoot>
              <tr>
                <td class="fw-bold">Total</td>
                <td class="text-end fw-bold">{{ getTotalQuantity(productQuantityByCategory) }}</td>
              </tr>
            </tfoot>
          </table>
        </c-col>
      </c-row>
    </c-card-body>
  </c-card>
  
  <!-- Top Selling Products -->
  <c-card class="mb-4">
    <c-card-header>
      <strong>Top Selling Products by Quantity</strong>
    </c-card-header>
    <c-card-body>
      <table cTable [hover]="true" [responsive]="true">
        <thead>
          <tr>
            <th>#</th>
            <th>Product Name</th>
            <th class="text-center">Quantity Sold</th>
            <th class="text-end">Revenue</th>
            <th class="text-end">Avg. Price</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let product of topSellingProducts; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ product.name }}</td>
            <td class="text-center fw-bold">{{ product.quantity }}</td>
            <td class="text-end">৳{{ product.revenue | number }}</td>
            <td class="text-end">৳{{ product.revenue / product.quantity | number:'1.0-0' }}</td>
          </tr>
        </tbody>
      </table>
    </c-card-body>
  </c-card>
  

  <!-- Add this section to your dashboard.component.html file -->
<c-card class="mb-4">
  <c-card-header>
    <strong>Installment Customers</strong>
  </c-card-header>
  <c-card-body>
    <div class="table-responsive">
      <table cTable class="installment-table">
        <thead>
          <tr>
            <th>Customer</th>
            <th>Product</th>
            <th>Installments</th>
            <th>Amount</th>
            <th>Next Due Date</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let person of paginatedInstallmentPersons">
            <td>{{ person.name }}</td>
            <td>{{ person.product }}</td>
            <td>
              <div class="installment-details">
                <span class="installment-count">{{ person.paidInstallments }}/{{ person.totalInstallments }}</span>
                <span class="installment-total">({{ person.dueInstallments }} due)</span>
              </div>
              <div class="installment-progress">
                <div class="progress-bar" 
                     [ngClass]="{
                       'bg-success': person.status === 'Regular',
                       'bg-warning': person.status === 'Substandard',
                       'bg-danger': person.status === 'Doubtful' || person.status === 'Bad'
                     }"
                     [style.width.%]="(person.paidInstallments / person.totalInstallments) * 100">
                </div>
              </div>
            </td>
            <td>
              <div>৳{{ person.totalAmount | number }}</div>
              <small class="text-success">Paid: ৳{{ person.paidAmount | number }}</small>
              <small class="text-danger d-block">Due: ৳{{ person.remainingAmount | number }}</small>
            </td>
            <td>{{ person.nextDueDate | date:'mediumDate' }}</td>
            <td>
              <c-badge [color]="
                person.status === 'Regular' ? 'success' : 
                person.status === 'Substandard' ? 'warning' : 
                person.status === 'Doubtful' ? 'danger' : 'dark'
              ">
                {{ person.status }}
              </c-badge>
              <small class="d-block mt-1" *ngIf="person.status !== 'Regular'">
                {{ person.daysSinceLastPayment }} days overdue
              </small>
            </td>
            <td>
              <button cButton color="primary" size="sm" (click)="openInstallmentModal(person)">
                <svg cIcon name="cilOptions"></svg>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <!-- Pagination -->
    <nav aria-label="Installment customers pagination">
      <ul class="pagination">
        <li class="page-item" [ngClass]="{'disabled': currentPage === 1}">
          <a class="page-link" (click)="previousPage()" aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
        <li class="page-item" *ngFor="let page of [].constructor(totalPages); let i = index" 
            [ngClass]="{'active': currentPage === i + 1}">
          <a class="page-link" (click)="changePage(i + 1)">{{ i + 1 }}</a>
        </li>
        <li class="page-item" [ngClass]="{'disabled': currentPage === totalPages}">
          <a class="page-link" (click)="nextPage()" aria-label="Next">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
      </ul>
    </nav>
  </c-card-body>
</c-card>



  <!-- Defaulter Installment Persons -->
  <!-- <c-card class="mb-4">
    <c-card-header>
      <strong>Defaulter Installment Customers</strong>
    </c-card-header>
    <c-card-body>
      <table cTable [hover]="true" [responsive]="true" *ngIf="defaulters.length > 0">
        <thead>
          <tr>
            <th>ID</th>
            <th>Customer Name</th>
            <th>Product</th>
            <th>Total Amount</th>
            <th>Paid Amount</th>
            <th>Remaining</th>
            <th>Next Due Date</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let person of defaulters">
            <td>{{ person.id }}</td>
            <td>{{ person.name }}</td>
            <td>{{ person.product }}</td>
            <td>৳{{ person.totalAmount | number }}</td>
            <td>৳{{ person.paidAmount | number }}</td>
            <td>৳{{ person.remainingAmount | number }}</td>
            <td>{{ person.nextDueDate | date }}</td>
            <td>
              <c-badge color="danger">
                Defaulter
              </c-badge>
            </td>
          </tr>
        </tbody>
      </table>
      
      <div *ngIf="defaulters.length === 0" class="text-center py-4">
        <p>No defaulters found.</p>
      </div>
    </c-card-body>
  </c-card> -->
</div>

<!-- STAFF/ASSOCIATE DASHBOARD -->
<div *ngIf="userRole === 'staff'">
  <h1 class="mb-4">Staff Dashboard</h1>
  
  <!-- Staff Stats Cards -->
  <c-row>
    <c-col sm="6" lg="4">
      <c-card class="mb-4 text-white bg-primary">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">{{ totalCommission | number }}</div>
            <div>Total Product Sales (Month)</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="75" aria-label="Commission Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col>
    
    <c-col sm="6" lg="4">
      <c-card class="mb-4 text-white bg-info">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">{{ totalCustomers }}</div>
            <div>Total Customers</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="80" aria-label="Customers Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col>
    
    <c-col sm="6" lg="4">
      <c-card class="mb-4 text-white bg-warning">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">{{ totalMonthlyInstallments }}</div>
            <div>Installment Customers (Month)</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="60" aria-label="Installment Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col>
  </c-row>
  
  <!-- Product Search -->
  <!-- <c-card class="mb-4">
    <c-card-header>
      <strong>Product Search</strong>
    </c-card-header>
    <c-card-body>
      <c-row class="mb-3">
        <c-col md="6">
          <div class="input-group">
            <input 
              cFormControl 
              placeholder="Search products by name, category, or supplier..." 
              [(ngModel)]="searchQuery"
              (keyup.enter)="searchProducts()"
            />
            <button cButton color="primary" type="button" (click)="searchProducts()">
              <svg cIcon name="cilSearch"></svg> Search
            </button>
            <button cButton color="secondary" type="button" (click)="clearSearch()" *ngIf="searchQuery">
              <svg cIcon name="cilX"></svg> Clear
            </button>
          </div>
        </c-col>
      </c-row>
      
      <table cTable [hover]="true" [responsive]="true" *ngIf="filteredProducts.length > 0">
        <thead>
          <tr>
            <th>ID</th>
            <th>Product Name</th>
            <th>Category</th>
            <th>Price</th>
            <th>Stock</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let product of filteredProducts">
            <td>{{ product.id }}</td>
            <td>{{ product.name }}</td>
            <td>{{ product.category }}</td>
            <td>৳{{ product.price | number }}</td>
            <td>{{ product.stock }}</td>
            <td>
              <c-badge [color]="
                product.status === 'In Stock' ? 'success' : 
                product.status === 'Low Stock' ? 'warning' : 'danger'
              ">
                {{ product.status }}
              </c-badge>
            </td>
          </tr>
        </tbody>
      </table>
      
      <div *ngIf="filteredProducts.length === 0" class="text-center py-4">
        <p>No products found matching your search criteria.</p>
      </div>
    </c-card-body>
  </c-card> -->
  
  <!-- Commission Chart -->
  <c-card class="mb-4">
    <c-card-header>
      <strong>Monthly Product Sales</strong>
    </c-card-header>
    <c-card-body>
      <c-chart
        [data]="commissionChart.data"
        [height]="300"
        [options]="commissionChart.options"
        [type]="commissionChart.type"
      >
        Commission chart
      </c-chart>
    </c-card-body>
  </c-card>
  
  <!-- Defaulter Installment Persons -->
  <c-card class="mb-4">
    <c-card-header>
      <strong>Defaulter Installment Customers</strong>
    </c-card-header>
    <c-card-body>
      <table cTable [hover]="true" [responsive]="true" *ngIf="defaulters.length > 0">
        <thead>
          <tr>
            <th>ID</th>
            <th>Customer Name</th>
            <th>Product</th>
            <th>Total Amount</th>
            <th>Paid Amount</th>
            <th>Remaining</th>
            <th>Next Due Date</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let person of defaulters">
            <td>{{ person.id }}</td>
            <td>{{ person.name }}</td>
            <td>{{ person.product }}</td>
            <td>৳{{ person.totalAmount | number }}</td>
            <td>৳{{ person.paidAmount | number }}</td>
            <td>৳{{ person.remainingAmount | number }}</td>
            <td>{{ person.nextDueDate | date }}</td>
            <td>
              <c-badge color="danger">
                Defaulter
              </c-badge>
            </td>
          </tr>
        </tbody>
      </table>
      
      <div *ngIf="defaulters.length === 0" class="text-center py-4">
        <p>No defaulters found.</p>
      </div>
    </c-card-body>
  </c-card>
</div>

<!-- SUPPLIER DASHBOARD -->
<div *ngIf="userRole === 'supplier'">
  <h1 class="mb-4">Executive Associate Dashboard</h1>
  
  <!-- Supplier Stats Cards - First Row -->
  <c-row>
    <!-- <c-col sm="6" lg="6">
      <c-card class="mb-4 text-white bg-primary">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">৳{{ totalSupplierSales | number }}</div>
            <div>Total Product Sales</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="75" aria-label="Sales Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col> -->
    
    <!-- <c-col sm="6" lg="6">
      <c-card class="mb-4 text-white bg-success">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">{{ totalCommissionProducts }}</div>
            <div>Commission Products</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="65" aria-label="Commission Products Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col> -->
  </c-row>
  
  <!-- Additional Supplier Stats Cards - Second Row -->
  <c-row>
    <c-col sm="6" lg="3">
      <c-card class="mb-4 text-white bg-info">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">৳{{ supplierInstallmentCollection | number }}</div>
            <div>Total Product Sales</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="70" aria-label="Installment Collection Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col>


    <c-col sm="6" lg="3">
      <c-card class="mb-4 text-white bg-info">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">৳{{ supplierInstallmentCollection | number }}</div>
            <div>Installment Collection</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="70" aria-label="Installment Collection Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col>


    
    <c-col sm="6" lg="3">
      <c-card class="mb-4 text-white bg-warning">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">৳{{ supplierPrinciple | number }}</div>
            <div>Principle Amount</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="85" aria-label="Principle Amount Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col>
    
    <c-col sm="6" lg="3">
      <c-card class="mb-4 text-white bg-danger">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">৳{{ supplierProfit | number }}</div>
            <div>Profit Amount</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="60" aria-label="Profit Amount Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col>
  </c-row>
  
  <!-- Add this card after the stat cards in the supplier dashboard section -->
  <c-card class="mb-4">
    <c-card-header>
      <strong>Installment Overview</strong>
      <small class="ms-1">(Current Month)</small>
    </c-card-header>
    <c-card-body>
      <c-row>
        <c-col sm="6" xl="6">
          <div class="border-start border-start-4 border-start-success py-1 px-3 mb-3">
            <div class="text-medium-emphasis small">Principle Collected</div>
            <div class="fs-5 fw-semibold d-flex align-items-center">
              ৳{{ supplierPrinciple | number }}
              <span class="ms-2 small text-success">
                <i class="fas fa-arrow-up"></i> 12% from last month
              </span>
            </div>
          </div>
        </c-col>
        <c-col sm="6" xl="6">
          <div class="border-start border-start-4 border-start-info py-1 px-3 mb-3">
            <div class="text-medium-emphasis small">Profit Collected</div>
            <div class="fs-5 fw-semibold d-flex align-items-center">
              ৳{{ supplierProfit | number }}
              <span class="ms-2 small text-info">
                <i class="fas fa-arrow-up"></i> 8% from last month
              </span>
            </div>
          </div>
        </c-col>
      </c-row>
      
      <div class="mb-3">
        <div class="d-flex justify-content-between mb-1">
          <div>Collection Progress</div>
          <div>72%</div>
        </div>
        <c-progress thin>
          <c-progress-bar [value]="72" color="success"></c-progress-bar>
        </c-progress>
      </div>
      
      <c-row class="mt-4">
        <c-col sm="12">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <div class="text-medium-emphasis">Total Outstanding</div>
              <div class="fs-4 fw-semibold">৳{{ 450000 - supplierInstallmentCollection | number }}</div>
            </div>
            <button cButton color="primary" size="sm" class="d-flex align-items-center">
              <i class="fas fa-list me-2"></i> View All Installments
            </button>
          </div>
        </c-col>
      </c-row>
    </c-card-body>
  </c-card>
  
  <!-- Rest of supplier dashboard content remains unchanged -->
  <!-- Supplier Products -->
  <c-card class="mb-4">
    <c-card-header>
      <strong>Your Products</strong>
    </c-card-header>
    <c-card-body>
      <table cTable [hover]="true" [responsive]="true">
        <thead>
          <tr>
            <th>ID</th>
            <th>Product Name</th>
            <th>Category</th>
            <th>Price</th>
            <th>Stock</th>
            <th>Sales</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let product of products">
            <td>{{ product.id }}</td>
            <td>{{ product.name }}</td>
            <td>{{ product.category }}</td>
            <td>৳{{ product.price | number }}</td>
            <td>{{ product.stock }}</td>
            <td>{{ product.sales }}</td>
            <td>
              <c-badge [color]="
                product.status === 'In Stock' ? 'success' : 
                product.status === 'Low Stock' ? 'warning' : 'danger'
              ">
                {{ product.status }}
              </c-badge>
            </td>
          </tr>
        </tbody>
      </table>
    </c-card-body>
  </c-card>
  
  <!-- Monthly Sales Chart for Supplier -->
  <c-card class="mb-4">
    <c-card-header>
      <strong>Monthly Product Sales</strong>
    </c-card-header>
    <c-card-body>
      <c-row>
        <c-col lg="8">
          <c-chart
            [data]="salesChart.data"
            [height]="300"
            [options]="salesChart.options"
            [type]="salesChart.type"
          >
            Sales chart
          </c-chart>
        </c-col>
        <c-col lg="4">
          <h5 class="mb-3">Your Products by Quantity</h5>
          <table cTable [hover]="true" [small]="true" class="mb-4">
            <thead>
              <tr>
                <th>Product</th>
                <th class="text-end">Quantity Sold</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let product of products">
                <td>{{ product.name }}</td>
                <td class="text-end fw-bold">{{ product.sales }}</td>
              </tr>
            </tbody>
            <tfoot>
              <tr>
                <td class="fw-bold">Total</td>
                <td class="text-end fw-bold">{{ getTotalProductSales(products) }}</td>
              </tr>
            </tfoot>
          </table>
        </c-col>
      </c-row>
    </c-card-body>
  </c-card>
</div>

<!-- EMPLOYEE DASHBOARD -->
<div *ngIf="userRole === 'employee'">
  <h1 class="mb-4">Sales Associate Dashboard</h1>
  
  <!-- Employee Stats Cards -->
  <c-row>
    <c-col sm="6" lg="3">
      <c-card class="mb-4 text-white bg-primary">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">{{ totalCustomers }}</div>
            <div>Total Customers</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="75" aria-label="Customers Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col>
    
    <c-col sm="6" lg="3">
      <c-card class="mb-4 text-white bg-info">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">{{ totalMonthlyInstallments }}</div>
            <div>Installment Customers</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="80" aria-label="Installment Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col>
    <c-col sm="6" lg="3">
      <c-card class="mb-4 text-white bg-warning">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">৳{{ supplierPrinciple | number }}</div>
            <div>Pending Installment</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="85" aria-label="Principle Amount Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col>


    <c-col sm="6" lg="3">
      <c-card class="mb-4 text-white bg-danger">
        <c-card-body class="pb-0 d-flex justify-content-between align-items-start">
          <div>
            <div class="fs-4 fw-semibold">৳{{ supplierProfit | number }}</div>
            <div>Commission Amount</div>
          </div>
          <div class="dropdown">
            <button cButton color="transparent" size="sm" class="text-white" type="button">
              <svg cIcon name="cilOptions"></svg>
            </button>
          </div>
        </c-card-body>
        <c-card-footer class="bg-transparent border-0 pb-3">
          <c-progress thin color="white" value="60" aria-label="Profit Amount Progress"></c-progress>
        </c-card-footer>
      </c-card>
    </c-col>
  </c-row>
  

  <c-card class="mb-4">
    <c-card-header>
      <div class="d-flex justify-content-between align-items-center">
        <strong>Installment Customers</strong>
        <div class="d-flex">
          <div class="input-group">
            <input 
              cFormControl 
              placeholder="Search by name, voucher, status..." 
              [(ngModel)]="employeeSearchQuery"
              (keyup.enter)="searchInstallments()"
              class="search-input"
            />
            <button cButton color="primary" type="button" (click)="searchInstallments()">
              <svg cIcon name="cilSearch"></svg> Search
            </button>
            <button cButton color="secondary" type="button" (click)="clearInstallmentSearch()" *ngIf="employeeSearchQuery">
              <svg cIcon name="cilX"></svg> Clear
            </button>
          </div>
        </div>
      </div>
    </c-card-header>
    <c-card-body>
      <!-- Search result summary -->
      <div class="search-result-info mb-3" *ngIf="employeeSearchQuery">
        <span class="text-muted">
          Found {{ filteredInstallmentPersons.length }} results for "{{ employeeSearchQuery }}"
        </span>
      </div>
      
      <div class="table-responsive">
        <table cTable class="installment-table">
          <thead>
            <tr>
              <th>Customer</th>
              <th>Voucher No</th>
              <!-- <th>Regular</th>
              <th>Sub Standard</th>
              <th>Doubtful</th>
              <th>Bad</th>
              <th>Installments</th> -->
              <th>Amount</th>
              <th>Next Due Date</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let person of paginatedInstallmentPersons">
              <td>{{ person.name }}</td>
              <td>VNB{{ person.id }}</td>
              <!-- <td>৳{{ person.totalAmount | number }}</td>
              <td>৳{{ person.paidAmount | number }}</td>
              <td>৳{{ person.remainingAmount | number }}</td>
              <td>৳{{ 0 | number }}</td>
              <td>
                <div class="installment-details">
                  <span class="installment-count">{{ person.paidInstallments }}/{{ person.totalInstallments }}</span>
                  <span class="installment-total">({{ person.dueInstallments }} due)</span>
                </div>
                <div class="installment-progress">
                  <div class="progress-bar" 
                       [ngClass]="{
                         'bg-success': person.status === 'Regular',
                         'bg-warning': person.status === 'Substandard',
                         'bg-danger': person.status === 'Doubtful' || person.status === 'Bad'
                       }"
                       [style.width.%]="(person.paidInstallments / person.totalInstallments) * 100">
                  </div>
                </div>
              </td> -->
              <td>
                <div>৳{{ person.totalAmount | number }}</div>
                <small class="text-success">Paid: ৳{{ person.paidAmount | number }}</small>
                <small class="text-danger d-block">Due: ৳{{ person.remainingAmount | number }}</small>
              </td>
              <td>{{ person.nextDueDate | date:'mediumDate' }}</td>
              <td>
                <c-badge [color]="
                  person.status === 'Regular' ? 'success' : 
                  person.status === 'Substandard' ? 'warning' : 
                  person.status === 'Doubtful' ? 'danger' : 'dark'
                ">
                  {{ person.status }}
                </c-badge>
                <small class="d-block mt-1" *ngIf="person.status !== 'Regular'">
                  {{ person.daysSinceLastPayment }} days overdue
                </small>
              </td>
              <td>
                <button cButton color="primary" size="sm" (click)="openInstallmentModal(person)">
                  <svg cIcon name="cilOptions"></svg>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <!-- Empty state message when no results found -->
      <div *ngIf="filteredInstallmentPersons.length === 0" class="text-center py-4">
        <p>No installment customers found matching your search criteria.</p>
        <button cButton color="primary" size="sm" (click)="clearInstallmentSearch()">
          <svg cIcon name="cilReload"></svg> Reset Search
        </button>
      </div>
      
      <!-- Pagination - This remains the same as it's using the updated paginatedInstallmentPersons -->
      <nav aria-label="Installment customers pagination" *ngIf="filteredInstallmentPersons.length > 0">
        <ul class="pagination">
          <li class="page-item" [ngClass]="{'disabled': currentPage === 1}">
            <a class="page-link" (click)="previousPage()" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
            </a>
          </li>
          <li class="page-item" *ngFor="let page of [].constructor(totalPages); let i = index" 
              [ngClass]="{'active': currentPage === i + 1}">
            <a class="page-link" (click)="changePage(i + 1)">{{ i + 1 }}</a>
          </li>
          <li class="page-item" [ngClass]="{'disabled': currentPage === totalPages}">
            <a class="page-link" (click)="nextPage()" aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
            </a>
          </li>
        </ul>
      </nav>
    </c-card-body>
  </c-card>


  <!-- Product Search -->
  <!-- <c-card class="mb-4">
    <c-card-header>
      <strong>Product Search</strong>
    </c-card-header>
    <c-card-body>
      <c-row class="mb-3">
        <c-col md="6">
          <div class="input-group">
            <input 
              cFormControl 
              placeholder="Search products by name, category, or supplier..." 
              [(ngModel)]="searchQuery"
              (keyup.enter)="searchProducts()"
            />
            <button cButton color="primary" type="button" (click)="searchProducts()">
              <svg cIcon name="cilSearch"></svg> Search
            </button>
            <button cButton color="secondary" type="button" (click)="clearSearch()" *ngIf="searchQuery">
              <svg cIcon name="cilX"></svg> Clear
            </button>
          </div>
        </c-col>
      </c-row>
      
      <table cTable [hover]="true" [responsive]="true" *ngIf="filteredProducts.length > 0">
        <thead>
          <tr>
            <th>ID</th>
            <th>Product Name</th>
            <th>Category</th>
            <th>Price</th>
            <th>Stock</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let product of filteredProducts">
            <td>{{ product.id }}</td>
            <td>{{ product.name }}</td>
            <td>{{ product.category }}</td>
            <td>৳{{ product.price | number }}</td>
            <td>{{ product.stock }}</td>
            <td>
              <c-badge [color]="
                product.status === 'In Stock' ? 'success' : 
                product.status === 'Low Stock' ? 'warning' : 'danger'
              ">
                {{ product.status }}
              </c-badge>
            </td>
          </tr>
        </tbody>
      </table>
      
      <div *ngIf="filteredProducts.length === 0" class="text-center py-4">
        <p>No products found matching your search criteria.</p>
      </div>
    </c-card-body>
  </c-card>
   -->

   
  <!-- Installment Persons -->
  <!-- <c-card class="mb-4">
    <c-card-header>
      <strong>Installment Customers</strong>
    </c-card-header>
    <c-card-body>
      <table cTable [hover]="true" [responsive]="true" *ngIf="installmentPersons.length > 0">
        <thead>
          <tr>
            <th>ID</th>
            <th>Customer Name</th>
            <th>Voucher No</th>
            <th>Regular</th>
            <th>Sub Standard</th>
            <th>Doubtful</th>
            <th>Bad</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let person of installmentPersons">
            <td>{{ person.id }}</td>
            <td>{{ person.name }}</td>         
               <td>VNB584642</td>
            <td>৳{{ person.totalAmount | number }}</td>
            <td>৳{{ person.paidAmount | number }}</td>
            <td>৳{{ person.remainingAmount | number }}</td>
            <td>৳{{ 00 | number }}</td>

            <td>
              <c-badge [color]="
                person.status === 'Regular' ? 'success' : 
                person.status === 'Substandard' ? 'warning' : 
                person.status === 'Doubtful' ? 'danger' : 'dark'
              ">
                {{ person.status }}
              </c-badge>
              <small class="d-block mt-1" *ngIf="person.status !== 'Regular'">
                {{ person.daysSinceLastPayment }} days overdue
              </small>
            </td>
          </tr>
        </tbody>
      </table>
      
      <div *ngIf="installmentPersons.length === 0" class="text-center py-4">
        <p>No installment customers found.</p>
      </div>
    </c-card-body>
  </c-card> -->
</div>

<!-- Add Modal at the end of the Employee Dashboard section -->
<c-modal 
  [visible]="installmentModalVisible" 
  (visibleChange)="handleModalChange($event)"
  size="lg"
>
  <c-modal-header>
    <h5 cModalTitle>Customer Installment Details</h5>
    <button (click)="closeInstallmentModal()" cButtonClose></button>
  </c-modal-header>
  <c-modal-body *ngIf="selectedInstallmentPerson">
    <div class="customer-header mb-4">
      <h3>{{ selectedInstallmentPerson.name }}</h3>
      <div class="customer-meta">
        <span class="badge bg-secondary me-2">Voucher: VNB{{ selectedInstallmentPerson.id }}</span>
        <span class="badge" [ngClass]="{
          'bg-success': selectedInstallmentPerson.status === 'Regular',
          'bg-warning': selectedInstallmentPerson.status === 'Substandard',
          'bg-danger': selectedInstallmentPerson.status === 'Doubtful',
          'bg-dark': selectedInstallmentPerson.status === 'Bad'
        }">{{ selectedInstallmentPerson.status }}</span>
      </div>
    </div>
    
    <div class="row mb-4">
      <div class="col-md-6">
        <h5 class="mb-3">Installment Status</h5>
        <div class="installment-status-card">
          <div class="installment-progress-wrapper mb-3">
            <div class="d-flex justify-content-between mb-1">
              <small>Completion</small>
              <small>{{ (selectedInstallmentPerson.paidInstallments / selectedInstallmentPerson.totalInstallments) * 100 | number:'1.0-0' }}%</small>
            </div>
            <div class="progress">
              <div class="progress-bar"
                [ngClass]="{
                  'bg-success': selectedInstallmentPerson.status === 'Regular',
                  'bg-warning': selectedInstallmentPerson.status === 'Substandard',
                  'bg-danger': selectedInstallmentPerson.status === 'Doubtful' || selectedInstallmentPerson.status === 'Bad'
                }"
                [style.width.%]="(selectedInstallmentPerson.paidInstallments / selectedInstallmentPerson.totalInstallments) * 100">
              </div>
            </div>
          </div>
          
          <div class="installment-counts">
            <div class="row">
              <div class="col-6 mb-3">
                <div class="installment-count-item border-start border-start-4 border-start-success p-2">
                  <div class="small text-muted">Regular</div>
                  <div class="fs-5 fw-bold">৳{{ selectedInstallmentPerson.totalAmount | number }}</div>
                </div>
              </div>
              <div class="col-6 mb-3">
                <div class="installment-count-item border-start border-start-4 border-start-warning p-2">
                  <div class="small text-muted">Substandard</div>
                  <div class="fs-5 fw-semibold">৳{{ selectedInstallmentPerson.paidAmount | number }}</div>
                </div>
              </div>
              <div class="col-6 mb-3">
                <div class="installment-count-item border-start border-start-4 border-start-danger p-2">
                  <div class="small text-muted">Doubtful</div>
                  <div class="fs-5 fw-semibold">৳{{ selectedInstallmentPerson.remainingAmount | number }}</div>
                </div>
              </div>
              <div class="col-6 mb-3">
                <div class="installment-count-item border-start border-start-4 border-start-dark p-2">
                  <div class="small text-muted">Bad</div>
                  <div class="fs-5 fw-semibold">৳{{ 0 | number }}</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-md-6">
        <h5 class="mb-3">Payment Information</h5>
        <div class="payment-info-card">
          <div class="payment-info-item mb-3">
            <div class="d-flex justify-content-between">
              <div>Total Amount</div>
              <div class="fw-bold">৳{{ selectedInstallmentPerson.totalAmount | number }}</div>
            </div>
          </div>
          <div class="payment-info-item mb-3">
            <div class="d-flex justify-content-between">
              <div>Paid Amount</div>
              <div class="fw-bold text-success">৳{{ selectedInstallmentPerson.paidAmount | number }}</div>
            </div>
          </div>
          <div class="payment-info-item mb-3">
            <div class="d-flex justify-content-between">
              <div>Remaining Amount</div>
              <div class="fw-bold text-danger">৳{{ selectedInstallmentPerson.remainingAmount | number }}</div>
            </div>
          </div>
          <div class="payment-info-item mb-3">
            <div class="d-flex justify-content-between">
              <div>Installments</div>
              <div class="fw-bold">{{ selectedInstallmentPerson.paidInstallments }}/{{ selectedInstallmentPerson.totalInstallments }}</div>
            </div>
          </div>
          <div class="payment-info-item">
            <div class="d-flex justify-content-between">
              <div>Next Due Date</div>
              <div class="fw-bold">{{ selectedInstallmentPerson.nextDueDate | date:'mediumDate' }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <h5 class="mb-3">Recent Transactions</h5>
    <table cTable small>
      <thead>
        <tr>
          <th>Date</th>
          <th>Amount</th>
          <th>Installment No.</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <!-- Sample transaction data (you can replace with actual data if available) -->
        <tr>
          <td>{{ selectedInstallmentPerson.lastPaymentDate | date:'mediumDate' }}</td>
          <td>৳{{ selectedInstallmentPerson.totalAmount / selectedInstallmentPerson.totalInstallments | number }}</td>
          <td>{{ selectedInstallmentPerson.paidInstallments }}</td>
          <td><span class="badge bg-success">Paid</span></td>
        </tr>
        <tr *ngIf="selectedInstallmentPerson.paidInstallments > 1">
          <td>{{ getPreviousPaymentDate(selectedInstallmentPerson.lastPaymentDate) | date:'mediumDate' }}</td>
          <td>৳{{ selectedInstallmentPerson.totalAmount / selectedInstallmentPerson.totalInstallments | number }}</td>
          <td>{{ selectedInstallmentPerson.paidInstallments - 1 }}</td>
          <td><span class="badge bg-success">Paid</span></td>
        </tr>
      </tbody>
    </table>
  </c-modal-body>
  <c-modal-footer>
    <button cButton color="secondary" (click)="closeInstallmentModal()">Close</button>
    <button cButton color="primary">Process Payment</button>
  </c-modal-footer>
</c-modal>
